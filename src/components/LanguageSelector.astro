---
import { languages } from '@/i18n/utils';
import { getRelativeLocaleUrl } from 'astro:i18n';

const currentPath = Astro.url.pathname;
const currentLang = Astro.currentLocale || 'es';

// Eliminar el prefijo de idioma de la ruta actual para obtener la ruta base
const pathWithoutLang = currentPath.replace(/^\/(es|en)(\/|$)/, '/') || '/';
---

<div class="language-selector flex items-center gap-2">
  {
    Object.entries(languages).map(([lang, label]) => {
      const url = getRelativeLocaleUrl(lang, pathWithoutLang);
      const isActive = currentLang === lang;

      return (
        <a
          href={url}
          class:list={[
            'rounded-md px-3 py-1 text-sm font-medium transition-colors',
            isActive
              ? 'bg-blue-600 text-white'
              : 'text-gray-700 hover:bg-gray-200 dark:text-gray-300 dark:hover:bg-gray-700',
          ]}
          aria-current={isActive ? 'page' : undefined}
        >
          {label}
        </a>
      );
    })
  }
</div>
